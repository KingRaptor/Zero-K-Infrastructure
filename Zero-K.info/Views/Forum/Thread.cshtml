@using ZeroKWeb
@model ZeroKWeb.Controllers.ForumController.ThreadResult
@{
    Page.Title = Model.CurrentThread.Title + " - forum thread";
}
<div class="infoCell">
    @{Html.RenderPartial("ForumPath", Model.Path);}
</div>

<h1>@Html.ActionLink(Model.CurrentThread.Title, "Thread", new { id = Model.CurrentThread.ForumThreadID })</h1>

@if (!Model.CurrentThread.IsLocked)
{
    <br />
    <h3 class="textbutton">@Html.ActionLink("Post comment", "NewPost", new { threadID = Model.CurrentThread.ForumThreadID })</h3>
    <br />
}
@if (Global.IsZeroKAdmin)
{
    var db = new ZkData.ZkDataContext();
    <div class="admin">
        <form action="@Url.Action("AdminThread", new { threadID = Model.CurrentThread.ForumThreadID })" method="post">
            <select name="newcat">
                @foreach (var c in db.ForumCategories)
                {
                    <option value="@c.ForumCategoryID" @(c.ForumCategoryID == Model.CurrentThread.ForumCategoryID ? "selected='selected'" : "")>@c.Title</option>
                }
            </select>
            Pinned: @Html.CheckBox("isPinned", Model.CurrentThread.IsPinned)<br />
            Locked: @Html.CheckBox("isLocked", Model.CurrentThread.IsLocked)<br />

            <input type="submit" value="move" />
        </form>
    </div>
}
<div style="float:right">@string.Format("{0} posts, {1} views", Model.CurrentThread.PostCount, Model.CurrentThread.ViewCount)</div>
@Html.Action("GetPostList", new { threadID = Model.CurrentThread.ForumThreadID, GoToPost = Model.GoToPost })
@if (!Model.CurrentThread.IsLocked)
{
    <br />
    <h3 class="textbutton">@Html.ActionLink("Post comment", "NewPost", new { threadID = Model.CurrentThread.ForumThreadID })</h3>
    <br />
}

